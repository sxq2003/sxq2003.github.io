{
    "version": "https://jsonfeed.org/version/1",
    "title": "sxq • All posts by \"crypto\" category",
    "description": "",
    "home_page_url": "https://sxq2003.github.io",
    "items": [
        {
            "id": "https://sxq2003.github.io/2024/04/07/%E4%B8%80%E9%81%93%E7%BB%8F%E5%85%B8%E7%9A%84LWE/",
            "url": "https://sxq2003.github.io/2024/04/07/%E4%B8%80%E9%81%93%E7%BB%8F%E5%85%B8%E7%9A%84LWE/",
            "title": "一道经典的LWE",
            "date_published": "2024-04-07T01:16:12.000Z",
            "content_html": "<h1 id=\"problem\">Problem</h1>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> secret <span class=\"keyword\">import</span> flag</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">gravity</span>(<span class=\"params\">n,d=<span class=\"number\">0.25</span></span>):</span><br><span class=\"line\">    A=np.zeros([n,n])</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(n):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(n):</span><br><span class=\"line\">            A[i,j]=d/n*(d**<span class=\"number\">2</span>+((i-j)/n)**<span class=\"number\">2</span>)**(-<span class=\"number\">1.5</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> A</span><br><span class=\"line\"> </span><br><span class=\"line\">n=<span class=\"built_in\">len</span>(flag)</span><br><span class=\"line\">A=gravity(n)</span><br><span class=\"line\">x=np.array(<span class=\"built_in\">list</span>(flag))</span><br><span class=\"line\">b=A@x</span><br><span class=\"line\">np.savetxt(<span class=\"string\">&#x27;b.txt&#x27;</span>,b)</span><br></pre></td></tr></table></figure>\r\n<p>看似很简单，<span class=\"math inline\">\\(b=A*x\\)</span>，不就是个矩阵乘法嘛<span class=\"math inline\">\\(A、b\\)</span>都已知，直接<span class=\"math inline\">\\(x=b*A^{-1}\\)</span>不就好了。实则没这么简单。</p>\r\n<p>原因就在于<span class=\"math inline\">\\(A\\)</span>中的元素全都是浮点数，你回去会有精度损失，无法还原flag。这就需要我们把<span class=\"math inline\">\\(A\\)</span>中的元素放大(乘上一个很大的数，如<span class=\"math inline\">\\(10^{20}\\)</span>)，去掉小数点，但是这样处理之后会有误差，还要误差考虑进去，经典的LWE问题。</p>\r\n<p>设误差为<span class=\"math inline\">\\(s\\)</span>，则<span class=\"math inline\">\\(b+s=Ax\\)</span>，将LWE问题转换为SVP问题，因为<span class=\"math inline\">\\(A,b\\)</span>已知，<span class=\"math inline\">\\(s,x\\)</span>未知</p>\r\n<p>构造矩阵<span class=\"math inline\">\\(\\begin{pmatrix}A &amp; 0 \\\\ -b &amp; 1 \\end{pmatrix}\\)</span>作为基向量，有<span class=\"math inline\">\\(\\begin{pmatrix}x&amp;1 \\end{pmatrix}\\begin{pmatrix}A &amp; 0 \\\\ -b &amp; 1 \\end{pmatrix}=\\begin{pmatrix}s &amp; 1 \\end{pmatrix}\\)</span></p>\r\n<p>对<span class=\"math inline\">\\(\\begin{pmatrix}A &amp; 0 \\\\ -b &amp; 1 \\end{pmatrix}\\)</span>格基规约，利用LLL算法得到<span class=\"math inline\">\\(\\begin{pmatrix}s&amp; 1 \\end{pmatrix}\\)</span></p>\r\n<p>因此<span class=\"math inline\">\\(x=\\begin{pmatrix}s&amp; 1 \\end{pmatrix}\\begin{pmatrix}A &amp; 0 \\\\ -b &amp; 1 \\end{pmatrix}^{-1}\\)</span></p>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">gravity</span>(<span class=\"params\">n,d=<span class=\"number\">0.25</span></span>):</span><br><span class=\"line\">    A=np.zeros([n,n])</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(n):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(n):</span><br><span class=\"line\">            A[i,j]=d/n*(d**<span class=\"number\">2</span>+((i-j)/n)**<span class=\"number\">2</span>)**(-<span class=\"number\">1.5</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> A</span><br><span class=\"line\"> </span><br><span class=\"line\">b = np.loadtxt(<span class=\"string\">&#x27;b.txt&#x27;</span>)</span><br><span class=\"line\">n = <span class=\"number\">85</span></span><br><span class=\"line\">multiple = <span class=\"number\">10</span> ^ <span class=\"number\">20</span></span><br><span class=\"line\">A = gravity(n)</span><br><span class=\"line\"> </span><br><span class=\"line\">A = [[<span class=\"built_in\">int</span>(j * multiple) <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> i] <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> A] <span class=\"comment\"># 乘上一个大数</span></span><br><span class=\"line\">b = [<span class=\"built_in\">int</span>(i * (-<span class=\"number\">1</span>) * multiple) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> b] <span class=\"comment\">#把b转换成-b</span></span><br><span class=\"line\">M = [A[i] + [<span class=\"number\">0</span>] <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(n)]</span><br><span class=\"line\">M.append(b + [<span class=\"number\">1</span>])</span><br><span class=\"line\">M = Matrix(ZZ, n + <span class=\"number\">1</span>, n + <span class=\"number\">1</span>, M) <span class=\"comment\">#构造基向量</span></span><br><span class=\"line\">ans = M.LLL()[<span class=\"number\">0</span>] <span class=\"comment\"># 格基规约</span></span><br><span class=\"line\"><span class=\"comment\"># print(ans)</span></span><br><span class=\"line\">flag = M.solve_left(ans)</span><br><span class=\"line\"><span class=\"comment\"># print(bytes(flag))</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">bytes</span>(flag[:-<span class=\"number\">1</span>]).decode())</span><br></pre></td></tr></table></figure>\r\n",
            "tags": [
                "crypto",
                "lwe",
                "格"
            ]
        }
    ]
}